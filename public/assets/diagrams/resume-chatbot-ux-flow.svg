<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 520" style="background: #fefefe;">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
    <linearGradient id="chatChannel" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:0.3"/>
      <stop offset="100%" style="stop-color:#f3e5f5;stop-opacity:0.1"/>
    </linearGradient>
    <linearGradient id="editChannel" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:0.3"/>
      <stop offset="100%" style="stop-color:#e8f5e9;stop-opacity:0.1"/>
    </linearGradient>
  </defs>

  <text x="450" y="30" text-anchor="middle" font-family="system-ui, sans-serif" font-size="18" font-weight="600" fill="#1a1a1a">
    Parallel Streams: Chat + Live Document Updates
  </text>

  <g transform="translate(30, 120)">
    <rect x="0" y="0" width="110" height="90" rx="8" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
    <text x="55" y="35" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#1976d2">User</text>
    <text x="55" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#666">"Update my job</text>
    <text x="55" y="70" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#666">title"</text>
  </g>

  <line x1="140" y1="165" x2="170" y2="165" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>

  <rect x="170" y="80" width="400" height="100" rx="8" fill="url(#chatChannel)" stroke="#7b1fa2" stroke-width="1" stroke-dasharray="4,2"/>
  <text x="370" y="100" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#7b1fa2">CONVERSATION STREAM</text>

  <g transform="translate(180, 110)">
    <rect x="0" y="0" width="130" height="60" rx="6" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2"/>
    <text x="65" y="28" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#7b1fa2">Chat Interface</text>
    <text x="65" y="48" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#666">User/assistant text</text>
  </g>

  <line x1="310" y1="140" x2="360" y2="140" stroke="#7b1fa2" stroke-width="2" marker-end="url(#arrowhead)"/>

  <g transform="translate(370, 95)">
    <rect x="0" y="0" width="120" height="90" rx="6" fill="#fff3e0" stroke="#f57c00" stroke-width="2"/>
    <text x="60" y="28" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#f57c00">AI Agent</text>
    <text x="60" y="50" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#666">Responds in chat</text>
    <text x="60" y="70" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#666">Calls patch tool</text>
  </g>

  <line x1="430" y1="185" x2="430" y2="240" stroke="#388e3c" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
  <text x="442" y="220" font-family="system-ui, sans-serif" font-size="9" fill="#388e3c">tool call</text>

  <rect x="170" y="200" width="550" height="140" rx="8" fill="url(#editChannel)" stroke="#388e3c" stroke-width="1" stroke-dasharray="4,2"/>
  <text x="445" y="220" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#388e3c">ARTIFACT EDIT STREAM (PARALLEL)</text>

  <g transform="translate(350, 250)">
    <rect x="0" y="0" width="160" height="80" rx="6" fill="#e8f5e9" stroke="#388e3c" stroke-width="2"/>
    <text x="80" y="25" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#388e3c">Patch Tool</text>
    <text x="80" y="45" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#666">RFC 6902 ops</text>
    <rect x="15" y="55" width="130" height="18" rx="3" fill="#fff" stroke="#c8e6c9" stroke-width="1"/>
    <text x="80" y="67" text-anchor="middle" font-family="monospace, sans-serif" font-size="8" fill="#333">{op: "replace", path: "/work/0/title"}</text>
  </g>

  <line x1="510" y1="290" x2="560" y2="290" stroke="#388e3c" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="535" y="282" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#388e3c" font-style="italic">streaming patches</text>

  <g transform="translate(570, 245)">
    <rect x="0" y="0" width="140" height="90" rx="6" fill="#fff" stroke="#c2185b" stroke-width="2"/>
    <text x="70" y="25" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#c2185b">Resume JSON</text>
    <rect x="10" y="40" width="120" height="18" rx="2" fill="#ffebee" stroke="#ef5350" stroke-width="1"/>
    <text x="70" y="52" text-anchor="middle" font-family="monospace, sans-serif" font-size="8" fill="#c62828">"title": "Senior Dev"</text>
    <rect x="10" y="62" width="120" height="18" rx="2" fill="#f5f5f5" stroke="#ddd" stroke-width="1"/>
    <text x="70" y="74" text-anchor="middle" font-family="monospace, sans-serif" font-size="8" fill="#666">other fields unchanged</text>
  </g>

  <path d="M 640 280 Q 720 280 720 200 Q 720 140 500 140" fill="none" stroke="#c2185b" stroke-width="2" stroke-dasharray="4,2" marker-end="url(#arrowhead)"/>
  <text x="736" y="200" font-family="system-ui, sans-serif" font-size="9" fill="#c2185b">live UI update</text>

  <g transform="translate(450, 460)">
    <rect x="-400" y="0" width="800" height="45" rx="6" fill="#e3f2fd" stroke="#1976d2" stroke-width="1"/>
    <text x="0" y="20" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#1565c0">
      Key insight: chat text and artifact edits run in parallel, coordinated by tool calls
    </text>
    <text x="0" y="36" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#666">
      User sees conversation while structured patches stream into the resume without full replacement
    </text>
  </g>
</svg>
