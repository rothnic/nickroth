---
import { Card } from '@/components/retroui/Card';
import { Badge } from '@/components/retroui/Badge';
import { Button } from '@/components/retroui/Button';

export interface Props {
  title: string;
  description: string;
  image?: string;
  slug: string;
  company: string;
  role: string;
  impact?: string;
  tags: string[];
  stack: string[];
}

const {
  title,
  description,
  image,
  slug,
  company,
  role,
  impact,
  tags = [],
  stack = []
} = Astro.props;

const displayTags = [...tags, ...stack].slice(0, 5);
---

<Card className="h-full hover:translate-y-1 transition-transform duration-200 max-w-md" client:load>
  {image && (
    <figure class="p-4 pb-0">
      <img 
        src={image} 
        alt={title}
        class="w-full h-48 object-cover rounded border-2 border-black"
        data-view-transition-name={`work-image-${slug}`}
        loading="lazy"
      />
    </figure>
  )}
  
  <Card.Content className="p-6">
    <Card.Title className="mb-2">{title}</Card.Title>
    
    {impact && (
      <Card.Description className="text-primary font-semibold uppercase text-sm mb-3">
        {impact}
      </Card.Description>
    )}
    
    <Badge variant="outline" size="sm" className="mb-4">
      {role}
    </Badge>
    
    <div class="flex flex-wrap gap-1 mb-4">
      {displayTags.map((tag, index) => (
        index < 4 ? (
          <Badge variant="solid" size="sm">{tag}</Badge>
        ) : (
          <Badge variant="solid" size="sm">+{displayTags.length - 4}</Badge>
        )
      ))}
    </div>
    
    <div class="mt-auto">
      <Button variant="default" size="sm" client:load>
        <a href={`/work/${slug}`} class="no-underline text-inherit">View Details</a>
      </Button>
    </div>
  </Card.Content>
</Card>