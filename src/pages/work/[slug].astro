---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection, type CollectionEntry } from 'astro:content';
import {} from 'astro:transitions';

export async function getStaticPaths() {
  const workEntries = await getCollection('work');
  return workEntries.map((entry: CollectionEntry<'work'>) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

type Props = {
  entry: CollectionEntry<'work'>;
};

const { entry } = Astro.props as Props;
const { Content } = await entry.render();
const PLACEHOLDER_IMAGE = 'https://placehold.co/600x400';
const coverImage = entry.data.image?.trim() ? entry.data.image : PLACEHOLDER_IMAGE;
---

<BaseLayout title={`${entry.data.title} - Nick Roth`} description={entry.data.description}>
  <main class="py-20">
    <div class="container mx-auto px-4 max-w-4xl">
      <div transition:name={`work-container-${entry.slug}`} class="mb-8">
        <a href="/work" class="btn btn-ghost mb-4">‚Üê Back to Work</a>
        
        <figure class="mb-8">
          <img transition:name={`work-${entry.slug}`} src={coverImage} alt={entry.data.title} class="w-full h-64 object-cover rounded-lg shadow-lg" />
        </figure>

        <h1 transition:name={`work-title-${entry.slug}`} class="text-5xl font-bold mb-4">{entry.data.title}</h1>

        <div class="flex flex-wrap gap-4 mb-6 text-lg">
          <div class="badge badge-primary badge-lg">{entry.data.company}</div>
          <div class="badge badge-secondary badge-lg">{entry.data.role}</div>
        </div>
        
        <div class="text-sm opacity-75 mb-6">
          {entry.data.startDate.toLocaleDateString()} - {entry.data.endDate ? entry.data.endDate.toLocaleDateString() : 'Present'}
        </div>
        
        {entry.data.tags.length > 0 && (
          <div class="flex flex-wrap gap-2 mb-8">
            {entry.data.tags.map((tag: string) => (
              <div class="badge badge-outline">{tag}</div>
            ))}
          </div>
        )}
      </div>
      
      <div class="prose prose-lg max-w-none">
        <Content />
      </div>
    </div>
  </main>
</BaseLayout>