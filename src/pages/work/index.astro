---
import { getCollection } from 'astro:content';

import BaseLayout from '../../layouts/BaseLayout.astro';
import { WorkArchive } from '../../components/site/WorkArchive';

const workEntries = await getCollection('work');
const workItems = workEntries
  .sort((a, b) => b.data.startDate.getTime() - a.data.startDate.getTime())
  .map((item) => ({
    slug: item.slug,
    title: item.data.title,
    description: item.data.description,
    company: item.data.company,
    role: item.data.role,
    tags: item.data.tags,
    impact: item.data.impact,
    startDate: item.data.startDate.toISOString(),
    endDate: item.data.endDate ? item.data.endDate.toISOString() : undefined,
  }));
---
<BaseLayout title="Work â€“ Nick Roth">
  <div class="space-y-20 py-20">
    <WorkArchive client:load items={workItems} />
  </div>
</BaseLayout>
